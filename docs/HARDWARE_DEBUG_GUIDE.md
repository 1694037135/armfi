# ğŸ”§ ç¡¬ä»¶è°ƒè¯•å®Œæ•´æŒ‡å—

> **ç›®æ ‡**ï¼šå°†ä½ çš„ Zero æœºæ¢°è‡‚å®ä½“ç¡¬ä»¶æ¥å…¥ç³»ç»Ÿ,å®ç°è§’åº¦å›ä¼ å’Œæ‘„åƒå¤´æ ‡å®šã€‚
>
> **é¢„è®¡æ—¶é—´**ï¼š3-5 å¤©ï¼ˆé¦–æ¬¡è°ƒè¯•ï¼‰
>
> **å‰ç½®æ¡ä»¶**ï¼š
> - âœ… å·²å®Œæˆ [éƒ¨ç½²æŒ‡å—](DEPLOYMENT_GUIDE.md) ä¸­çš„ç³»ç»Ÿæ­å»º
> - âœ… æœºæ¢°è‡‚ç¡¬ä»¶å·²ç»„è£…å®Œæˆ
> - âœ… ç³»ç»Ÿå·²é€šè¿‡ Docker æ¨¡æ‹Ÿæµ‹è¯•
> - âœ… æœ‰ USB è½¬ä¸²å£çº¿ï¼ˆæˆ–è“ç‰™æ¨¡å—ï¼‰
> - âœ… æœ‰å¸¦ IP Camera çš„æ‰‹æœºï¼ˆæˆ– USB æ‘„åƒå¤´ï¼‰

---

## ğŸ“‹ æ€»ä½“æµç¨‹æ¦‚è§ˆ

```mermaid
graph TD
    A[Day 1: è¿æ¥ç¡¬ä»¶] --> B[Day 2: ä¸²å£è°ƒè¯•]
    B --> C[Day 3: è§’åº¦éªŒè¯]
    C --> D[Day 4: æ‘„åƒå¤´æ ‡å®š]
    D --> E[Day 5: æ•´ä½“æµ‹è¯•]
```

---

## ğŸ”Œ Day 1: ç¡¬ä»¶è¿æ¥ä¸ç¯å¢ƒå‡†å¤‡

### æ­¥éª¤ 1.1ï¼šç¡®è®¤ä¸²å£è¿æ¥

#### Windows ç³»ç»Ÿ

1. **è¿æ¥æœºæ¢°è‡‚ USB çº¿åˆ°ç”µè„‘**

2. **æŸ¥çœ‹ä¸²å£å·**ï¼š
   ```powershell
   # æ–¹å¼ 1ï¼šè®¾å¤‡ç®¡ç†å™¨
   devmgmt.msc
   # å±•å¼€ "ç«¯å£(COM å’Œ LPT)"
   # æ‰¾åˆ°ç±»ä¼¼ "USB-SERIAL CH340 (COM3)" çš„è®¾å¤‡
   
   # æ–¹å¼ 2ï¼šPowerShell
   [System.IO.Ports.SerialPort]::getportnames()
   ```

   **é¢„æœŸè¾“å‡º**ï¼š
   ```
   COM3
   COM5
   ```

3. **è®°å½•ä¸²å£å·**ï¼šä¾‹å¦‚ `COM3`

#### Linux ç³»ç»Ÿ

```bash
# æŸ¥çœ‹ä¸²å£è®¾å¤‡
ls /dev/ttyUSB* /dev/ttyACM*

# é¢„æœŸè¾“å‡º
/dev/ttyUSB0

# è®°å½•è®¾å¤‡è·¯å¾„
```

---

### æ­¥éª¤ 1.2ï¼šé…ç½®ä¸²å£å‚æ•°

ç¼–è¾‘ `ai-service/config.json`ï¼ˆåŸºäº `config.json.example`ï¼‰ï¼š

```json
{
  "SERIAL_ENABLED": true,
  "SERIAL_PORT": "COM3",           // Windows
  // "SERIAL_PORT": "/dev/ttyUSB0", // Linux
  "SERIAL_BAUDRATE": 115200,
  "SERIAL_TIMEOUT": 1.0,
  
  "CAMERA_ENABLED": false,   // å…ˆä¸å¯ç”¨æ‘„åƒå¤´
  "GEMINI_API_KEY": "your-key-here"
}
```

**å…³é”®å‚æ•°è¯´æ˜**ï¼š

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `SERIAL_PORT` | `COM3` | ä¸²å£å·ï¼Œæ ¹æ®å®é™…è°ƒæ•´ |
| `SERIAL_BAUDRATE` | `115200` | æ³¢ç‰¹ç‡ï¼Œéœ€ä¸ç¡¬ä»¶å›ºä»¶ä¸€è‡´ |
| `SERIAL_TIMEOUT` | `1.0` | è¯»å–è¶…æ—¶ï¼ˆç§’ï¼‰ |

---

### æ­¥éª¤ 1.3ï¼šæµ‹è¯•åŸºç¡€è¿æ¥

è¿è¡Œä¸²å£æµ‹è¯•è„šæœ¬ï¼š

```bash
cd ai-service
python -c "
import serial
ser = serial.Serial('COM3', 115200, timeout=1)
print('ä¸²å£å·²æ‰“å¼€:', ser.is_open)
ser.close()
"
```

**é¢„æœŸè¾“å‡º**ï¼š
```
ä¸²å£å·²æ‰“å¼€: True
```

**å¸¸è§é”™è¯¯**ï¼š

| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|------|---------|
| `PermissionError` | Linux æƒé™ä¸è¶³ | `sudo chmod 666 /dev/ttyUSB0` |
| `SerialException: Port already open` | ç«¯å£è¢«å ç”¨ | å…³é—­å…¶ä»–ä¸²å£ç›‘è§†å·¥å…· |
| `FileNotFoundError` | ä¸²å£å·é”™è¯¯ | é‡æ–°æ£€æŸ¥è®¾å¤‡ç®¡ç†å™¨ |

---

## ğŸ“¡ Day 2: ä¸²å£åè®®è°ƒè¯•

### æ­¥éª¤ 2.1ï¼šç†è§£ä½ çš„ç¡¬ä»¶åè®®

#### æ–¹å¼ Aï¼šå¦‚æœä½ æœ‰ç¡¬ä»¶çš„ä¸²å£æ–‡æ¡£

æŸ¥çœ‹å›ºä»¶æ–‡æ¡£ï¼Œç¡®è®¤ï¼š
1. **æ³¢ç‰¹ç‡**ï¼šé€šå¸¸æ˜¯ `115200`
2. **æ•°æ®æ ¼å¼**ï¼šJSON / CSV / è‡ªå®šä¹‰
3. **æŒ‡ä»¤æ ¼å¼**ï¼šä¾‹å¦‚ `#0P1500T1000\r\n`ï¼ˆèˆµæœºæ§åˆ¶ï¼‰
4. **å›ä¼ æ ¼å¼**ï¼šä¾‹å¦‚ `{angles:[30,45,60,0,90,0]}`

#### æ–¹å¼ B: ä½¿ç”¨æœ¬åœ°ä¸²å£ç›‘è§†å™¨ (æ¨è)

**å·¥å…·**: `serial_monitor.py` - æœ¬åœ° Python ä¸²å£ç›‘è§†å™¨

**ä¼˜ç‚¹**:
- âœ… æ— éœ€ä¸‹è½½å¤–éƒ¨è½¯ä»¶
- âœ… å½©è‰²è¾“å‡º,æ˜“äºé˜…è¯»
- âœ… è‡ªåŠ¨ä¿å­˜æ—¥å¿—
- âœ… å®æ—¶æ˜¾ç¤ºæ”¶å‘æ•°æ®

**æ“ä½œæ­¥éª¤**:

1. **å®‰è£…ä¾èµ–**:
   ```powershell
   pip install -r tools/requirements.txt
   ```

2. **å¯åŠ¨ç›‘è§†å™¨** (æ–¹å¼ 1 - ç›´æ¥å‘½ä»¤):
   ```powershell
   python tools/serial_monitor.py --port COM3 --baudrate 115200
   ```

3. **å¯åŠ¨ç›‘è§†å™¨** (æ–¹å¼ 2 - å›¾å½¢èœå•):
   ```powershell
   # Windows
   debug-tools.bat
   
   # Linux/MacOS
   ./debug-tools.sh
   ```
   ç„¶åé€‰æ‹© `[1] ä¸²å£ç›‘è§†å™¨`

4. **å‘é€æµ‹è¯•æŒ‡ä»¤**:
   åœ¨ç›‘è§†å™¨ä¸­ç›´æ¥è¾“å…¥å‘½ä»¤å¹¶å›è½¦:
   ```
   [å‘é€] > GET_ANGLES
   [å‘é€] > {"action":"get_status"}
   ```

5. **è§‚å¯Ÿè¿”å›æ•°æ®**,è®°å½•æ ¼å¼

**ç•Œé¢ç¤ºä¾‹**:
```
â”Œâ”€ ğŸ“¥ æ¥æ”¶ (RX) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [18:30:15.123] 0,30,45,60,0,90       â”‚
â”‚ [18:30:15.223] 0,30,45,60,0,90       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€ ğŸ“¤ å‘é€ (TX) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [18:30:14.500] GET_ANGLES            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…¸å‹åè®®ç¤ºä¾‹**ï¼š

```
# æ ¼å¼ 1ï¼šJSON
å‘é€: {"action":"get_angles"}
è¿”å›: {"angles_deg":[0,30,45,60,0,90]}

# æ ¼å¼ 2ï¼šCSV
å‘é€: GET_ANGLES\r\n
è¿”å›: 0,30,45,60,0,90\r\n

# æ ¼å¼ 3ï¼šè‡ªå®šä¹‰
å‘é€: ?STATUS
è¿”å›: A:0,30,45,60,0,90;E:0
```

---

### æ­¥éª¤ 2.2ï¼šä¿®æ”¹ `serial_transport.py`

æ ¹æ®ä½ çš„åè®®æ ¼å¼ï¼Œä¿®æ”¹ `read_status()` æ–¹æ³•ã€‚

#### ç¤ºä¾‹ï¼šé€‚é… CSV æ ¼å¼

å¦‚æœä½ çš„ç¡¬ä»¶è¿”å› `0,30,45,60,0,90\r\n`ï¼š

```python
# ai-service/serial_transport.py

def read_status(self):
    """è¯»å–æœºæ¢°è‡‚å½“å‰çŠ¶æ€ï¼ˆCSV æ ¼å¼ï¼‰"""
    if not self.connected:
        return self._mock_status()
    
    try:
        # å‘é€æŸ¥è¯¢æŒ‡ä»¤
        self.ser.write(b"GET_ANGLES\r\n")
        
        # è¯»å–è¿”å›
        line = self.ser.readline().decode('utf-8').strip()
        
        if not line:
            return self._mock_status()
        
        # è§£æ CSV: "0,30,45,60,0,90"
        angles_deg = [float(x) for x in line.split(',')]
        
        if len(angles_deg) != 6:
            raise ValueError(f"Expected 6 angles, got {len(angles_deg)}")
        
        return {
            "angles_deg": angles_deg,
            "angles_rad": [deg * 3.14159 / 180 for deg in angles_deg],
            "error_code": 0,
            "serial_mock": False
        }
    
    except Exception as e:
        print(f"Serial read error: {e}")
        return self._mock_status()
```

#### ç¤ºä¾‹ï¼šé€‚é… JSON æ ¼å¼

å¦‚æœä½ çš„ç¡¬ä»¶è¿”å› `{"angles":[0,30,45,60,0,90]}`ï¼š

```python
def read_status(self):
    """è¯»å–æœºæ¢°è‡‚å½“å‰çŠ¶æ€ï¼ˆJSON æ ¼å¼ï¼‰"""
    if not self.connected:
        return self._mock_status()
    
    try:
        # å‘é€æŸ¥è¯¢æŒ‡ä»¤
        self.ser.write(b'{"action":"get_status"}\r\n')
        
        # è¯»å–è¿”å›
        line = self.ser.readline().decode('utf-8').strip()
        
        if not line:
            return self._mock_status()
        
        # è§£æ JSON
        data = json.loads(line)
        angles_deg = data.get("angles", [0]*6)
        
        return {
            "angles_deg": angles_deg,
            "angles_rad": [deg * 3.14159 / 180 for deg in angles_deg],
            "error_code": data.get("error", 0),
            "serial_mock": False
        }
    
    except Exception as e:
        print(f"Serial read error: {e}")
        return self._mock_status()
```

---

### æ­¥éª¤ 2.3ï¼šä¿®æ”¹ `send_command()`

æ ¹æ®ä½ çš„ç¡¬ä»¶ï¼Œä¿®æ”¹å‘é€æŒ‡ä»¤çš„æ ¼å¼ã€‚

#### ç¤ºä¾‹ï¼šèˆµæœºåè®®ï¼ˆç±»ä¼¼ LX-16Aï¼‰

```python
def send_command(self, angles_rad):
    """å‘é€è§’åº¦æŒ‡ä»¤ï¼ˆèˆµæœºåè®®ï¼‰"""
    if not self.connected:
        print("[MOCK] Would send:", angles_rad)
        return True
    
    try:
        # è½¬æ¢ä¸ºèˆµæœºè„‰å®½ï¼ˆ500-2500Î¼sï¼‰
        # å‡è®¾ -90Â° = 500Î¼s, 90Â° = 2500Î¼s
        for i, angle_rad in enumerate(angles_rad):
            angle_deg = angle_rad * 180 / 3.14159
            pulse = int(1500 + angle_deg * 11.11)  # ä¸­å¿ƒ 1500Î¼s
            pulse = max(500, min(2500, pulse))
            
            # å‘é€æŒ‡ä»¤: #<ID>P<Pulse>T<Time>
            cmd = f"#{i}P{pulse}T1000\r\n"
            self.ser.write(cmd.encode())
        
        return True
    
    except Exception as e:
        print(f"Serial send error: {e}")
        return False
```

---

### æ­¥éª¤ 2.4ï¼šæµ‹è¯•ä¸²å£é€šä¿¡

åˆ›å»ºæµ‹è¯•è„šæœ¬ `ai-service/test_serial.py`ï¼š

```python
#!/usr/bin/env python3
import time
from serial_transport import SerialTransport

# åˆå§‹åŒ–
transport = SerialTransport(
    port="COM3",
    baudrate=115200,
    enabled=True
)

print("=== ä¸²å£æµ‹è¯•å¼€å§‹ ===\n")

# æµ‹è¯• 1: è¯»å–å½“å‰è§’åº¦
print("Test 1: è¯»å–è§’åº¦")
for i in range(5):
    status = transport.read_status()
    print(f"  [{i+1}] angles_deg: {status['angles_deg']}")
    print(f"      mock: {status['serial_mock']}")
    time.sleep(1)

print("\n" + "="*50 + "\n")

# æµ‹è¯• 2: å‘é€æ§åˆ¶æŒ‡ä»¤
print("Test 2: å‘é€æŒ‡ä»¤")
test_angles = [0.0, 0.5, 0.8, 0.0, -0.3, 0.0]  # å¼§åº¦
success = transport.send_command(test_angles)
print(f"  å‘é€ç»“æœ: {'æˆåŠŸ' if success else 'å¤±è´¥'}")

print("\n=== æµ‹è¯•å®Œæˆ ===")
transport.close()
```

è¿è¡Œæµ‹è¯•ï¼š

```bash
python ai-service/test_serial.py
```

**é¢„æœŸè¾“å‡ºï¼ˆæˆåŠŸï¼‰**ï¼š
```
=== ä¸²å£æµ‹è¯•å¼€å§‹ ===

Test 1: è¯»å–è§’åº¦
  [1] angles_deg: [0, 30, 45, 60, 0, 90]
      mock: False
  [2] angles_deg: [0, 30, 45, 60, 0, 90]
      mock: False
  ...

Test 2: å‘é€æŒ‡ä»¤
  å‘é€ç»“æœ: æˆåŠŸ

=== æµ‹è¯•å®Œæˆ ===
```

**é¢„æœŸè¾“å‡ºï¼ˆMock æ¨¡å¼ï¼‰**ï¼š
```
  [1] angles_deg: [0, 0, 0, 0, 0, 0]
      mock: True
```

---

## ğŸ¯ Day 3: è§’åº¦å›ä¼ éªŒè¯

### æ­¥éª¤ 3.1ï¼šå¯åŠ¨å®Œæ•´ç³»ç»Ÿ

```bash
cd robot-control-system
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f ai-service
```

**å…³é”®æ—¥å¿—**ï¼š
```
INFO: Serial connected: COM3 @ 115200
INFO: Telemetry broadcaster started (interval: 0.1s)
INFO: WebSocket /ws/mujoco opened
```

---

### æ­¥éª¤ 3.2ï¼šå‰ç«¯å®æ—¶ç›‘æ§

1. æ‰“å¼€æµè§ˆå™¨ `http://localhost`

2. ç‚¹å‡»å³ä¸Šè§’ **"å®ç‰©"** æŒ‰é’®ï¼Œåˆ‡æ¢åˆ° physical æ¨¡å¼

3. è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºï¼ˆæŒ‰ `F12`ï¼‰ï¼š
   ```javascript
   WebSocket message: {
     type: "telemetry",
     data: {
       angles_deg: [0, 30, 45, 60, 0, 90],
       serial_mock: false
     }
   }
   ```

4. **æ‰‹åŠ¨ç§»åŠ¨æœºæ¢°è‡‚**ï¼Œè§‚å¯Ÿå‰ç«¯è§’åº¦æ˜¯å¦å®æ—¶æ›´æ–°

**éªŒè¯æ–¹æ³•**ï¼š
- è½¬åŠ¨å…³èŠ‚ 1ï¼ˆåŸºåº§ï¼‰ â†’ å‰ç«¯æ˜¾ç¤ºçš„ç¬¬ 1 ä¸ªè§’åº¦åº”å˜åŒ–
- è½¬åŠ¨å…³èŠ‚ 2ï¼ˆå¤§è‡‚ï¼‰ â†’ ç¬¬ 2 ä¸ªè§’åº¦åº”å˜åŒ–
- ä»¥æ­¤ç±»æ¨

---

### æ­¥éª¤ 3.3ï¼šæ ¡å‡†è§’åº¦é›¶ç‚¹

å¦‚æœå‘ç°è§’åº¦åå·®ï¼ˆä¾‹å¦‚æœºæ¢°è‡‚æ°´å¹³ï¼Œä½†æ˜¾ç¤º 30Â°ï¼‰ï¼š

**æ–¹å¼ Aï¼šç¡¬ä»¶æ ¡å‡†ï¼ˆæ¨èï¼‰**
åœ¨å›ºä»¶ä¸­ä¿®æ­£è§’åº¦åç§»é‡ã€‚

**æ–¹å¼ Bï¼šè½¯ä»¶æ ¡å‡†**

ä¿®æ”¹ `serial_transport.py`ï¼š

```python
# è§’åº¦æ ¡å‡†åç§»é‡ï¼ˆæ ¹æ®å®é™…æµ‹é‡ï¼‰
ANGLE_OFFSETS = [0, -30, 10, 0, 5, 0]  # æ¯ä¸ªå…³èŠ‚çš„é›¶ç‚¹åç§»

def read_status(self):
    # ... è§£æå ...
    
    # åº”ç”¨æ ¡å‡†
    angles_deg = [
        raw_angles[i] + ANGLE_OFFSETS[i] 
        for i in range(6)
    ]
    
    return {
        "angles_deg": angles_deg,
        ...
    }
```

---

### æ­¥éª¤ 3.4ï¼šéªŒè¯æ§åˆ¶é—­ç¯

**æµ‹è¯•ç›®æ ‡**ï¼šå‘é€æŒ‡ä»¤ â†’ æœºæ¢°è‡‚ç§»åŠ¨ â†’ è§’åº¦å›ä¼ ç¡®è®¤

1. åœ¨å‰ç«¯ç‚¹å‡» **"åŸºåº§æ—‹è½¬"** æŒ‰é’®ï¼ˆA/D é”®ï¼‰

2. è§‚å¯Ÿï¼š
   - æœºæ¢°è‡‚æ˜¯å¦è½¬åŠ¨ âœ…
   - å‰ç«¯è§’åº¦æ˜¾ç¤ºæ˜¯å¦å˜åŒ– âœ…
   - æ˜¾ç¤ºè§’åº¦æ˜¯å¦ä¸å®é™…ä¸€è‡´ âœ…

**è°ƒè¯•å»ºè®®**ï¼š

å¦‚æœæœºæ¢°è‡‚ä¸åŠ¨ï¼š
- æ£€æŸ¥ `send_command()` æŒ‡ä»¤æ ¼å¼
- ç”¨ä¸²å£å·¥å…·æ‰‹åŠ¨å‘é€æŒ‡ä»¤éªŒè¯

å¦‚æœè§’åº¦ä¸å‡†ï¼š
- è°ƒæ•´ `ANGLE_OFFSETS` æ ¡å‡†å‚æ•°
- æ£€æŸ¥å¼§åº¦/è§’åº¦è½¬æ¢æ˜¯å¦æ­£ç¡®

---

## ğŸ“· Day 4: æ‘„åƒå¤´æ ‡å®š

### æ­¥éª¤ 4.0: ç”Ÿæˆ ArUco æ ‡è®° (æ–°å¢)

**ä½¿ç”¨æœ¬åœ°å·¥å…·ç”Ÿæˆæ ‡è®°,æ— éœ€è®¿é—®å¤–éƒ¨ç½‘ç«™!**

#### æ–¹å¼ 1: å•ä¸ªæ ‡è®°

```powershell
# ç”Ÿæˆ ID=0 çš„æ ‡è®°
python tools/generate_aruco_marker.py --id 0 --size 200
```

è¾“å‡º: `aruco_marker_0.png`

#### æ–¹å¼ 2: A4 æ‰“å°è¡¨ (æ¨è)

```powershell
# ç”ŸæˆåŒ…å«å¤šä¸ªæ ‡è®°çš„ A4 æ‰“å°è¡¨
python tools/generate_aruco_marker.py --sheet --ids 0 1 2 3 4 5 6 7 8 9 10 11
```

è¾“å‡º: `aruco_sheet_4x4_50.png`

**æ‰“å°å»ºè®®**:
- âœ… ä½¿ç”¨ A4 çº¸
- âœ… å½©è‰²æˆ–é»‘ç™½æ‰“å°å‡å¯
- âœ… ç¡®ä¿æ‰“å°è´¨é‡æ¸…æ™°

---

### æ­¥éª¤ 4.1: å‡†å¤‡æ‘„åƒå¤´

#### æ–¹æ¡ˆ A: IP Camera (æ¨è)

1. åœ¨æ‰‹æœºä¸Šå®‰è£… IP Camera åº”ç”¨:
   - Android: [IP Webcam](https://play.google.com/store/apps/details?id=com.pas.webcam)
   - iOS: [iVCam](https://apps.apple.com/app/ivcam/id1164464478)

2. å¯åŠ¨åº”ç”¨,è®°å½•è§†é¢‘æµåœ°å€:
   ```
   http://192.168.1.100:8080/video
   ```

3. ä¿®æ”¹ `config.json`:
   ```json
   {
     "CAMERA_ENABLED": true,
     "CAMERA_URL": "http://192.168.1.100:8080/video"
   }
   ```

#### æ–¹æ¡ˆ B: USB æ‘„åƒå¤´

```json
{
  "CAMERA_ENABLED": true,
  "CAMERA_URL": "0"  // 0 è¡¨ç¤ºé»˜è®¤æ‘„åƒå¤´
}
```

---

### æ­¥éª¤ 4.2: å›ºå®šæ‘„åƒå¤´ä½ç½®

**å…³é”®è¦æ±‚**ï¼š
1. æ‘„åƒå¤´ä½ç½®**å¿…é¡»å›ºå®š**ï¼Œæ ‡å®šåä¸èƒ½ç§»åŠ¨
2. å°½é‡ä¿¯è§†æ‹æ‘„ï¼ˆå‡å°‘é€è§†ç•¸å˜ï¼‰
3. ç¡®ä¿å·¥ä½œåŒºåŸŸå®Œå…¨å¯è§

**æ¨èå®‰è£…ä½ç½®**ï¼š
```
        ğŸ“· æ‘„åƒå¤´ï¼ˆä¿¯è§† 45Â°ï¼‰
         |
         |
    -----------
   |  ğŸ¤– æœºæ¢°è‡‚  |  å·¥ä½œåŒºåŸŸ
    -----------
```

---

### æ­¥éª¤ 4.3: ä½¿ç”¨æœ¬åœ°æ ‡å®šåŠ©æ‰‹ (æ¨èæ–°æ–¹æ³•)

**æœ¬åœ°æ ‡å®šåŠ©æ‰‹æä¾›å®æ—¶ ArUco æ£€æµ‹å’Œæ ‡å®šæµç¨‹!**

#### å¯åŠ¨æ ‡å®šåŠ©æ‰‹

```powershell
# ä½¿ç”¨é»˜è®¤æ‘„åƒå¤´
python tools/camera_calibration_helper.py

# ä½¿ç”¨ IP Camera
python tools/camera_calibration_helper.py --camera http://192.168.1.100:8080/video
```

#### æ“ä½œæµç¨‹

1. **å¯ç”¨ ArUco æ£€æµ‹**: æŒ‰ `a` é”®
   - å°†æ‰“å°çš„ ArUco æ ‡è®°æ”¾åœ¨å·¥ä½œåŒºåŸŸ
   - è½¯ä»¶ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶æ˜¾ç¤ºæ ‡è®°ä¸­å¿ƒç‚¹

2. **æ·»åŠ æ ‡å®šç‚¹**: æŒ‰ `ç©ºæ ¼` é”®
   - è¾“å…¥å›¾åƒåæ ‡ (u, v)
   - è¾“å…¥ä¸–ç•Œåæ ‡ (x, y, z)
   - é‡å¤è‡³å°‘ 4 æ¬¡

3. **è®¡ç®—æ ‡å®šçŸ©é˜µ**: æŒ‰ `c` é”®
   - è‡ªåŠ¨è®¡ç®—å˜æ¢çŸ©é˜µ
   - æ˜¾ç¤ºæ¯ä¸ªç‚¹çš„è¯¯å·®

4. **ä¿å­˜ç»“æœ**: æŒ‰ `s` é”®
   - ä¿å­˜åˆ° `calibration_data/calibration_YYYYMMDD_HHMMSS.json`

**ç•Œé¢ç¤ºä¾‹**:
```
â”Œâ”€ Camera Calibration Helper â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ArUco Detection ON                    â”‚
â”‚ Calibration Points: 4                 â”‚
â”‚                                        â”‚
â”‚    [æ‘„åƒå¤´ç”»é¢ + ArUco æ ‡è®°é«˜äº®]       â”‚
â”‚    â— 1  â— 2                           â”‚
â”‚    â— 3  â— 4                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æ­¥éª¤ 4.4: ä¼ ç»Ÿå‰ç«¯æ ‡å®šæµç¨‹ (å¤‡é€‰)

å¦‚æœä½ æ›´å–œæ¬¢ä½¿ç”¨å‰ç«¯ç•Œé¢æ ‡å®š:

1. æ‰“å¼€å‰ç«¯,ç‚¹å‡» **"æ‘„åƒå¤´"** æŒ‰é’®

2. åœ¨ç”»é¢ä¸Šç‚¹å‡»æ ‡è®°ç‰©ä½ç½® (é‡å¤ 4 æ¬¡)
   - æ¯æ¬¡ç‚¹å‡»åç§»åŠ¨æœºæ¢°è‡‚åˆ°è¯¥ç‚¹
   - è®°å½•åæ ‡

3. ç‚¹å‡» **"è®¡ç®—å˜æ¢çŸ©é˜µ"**

**é¢„æœŸè¾“å‡º**:
```
æ ‡å®šå®Œæˆ!
å˜æ¢çŸ©é˜µå·²ä¿å­˜: calibration_matrix.json
è¯¯å·®: 2.3 mm
```

---

### æ­¥éª¤ 4.5: éªŒè¯æ ‡å®šç²¾åº¦

1. åœ¨ç”»é¢ä¸Š**éšæœºç‚¹å‡»ä¸€ä¸ªæ–°ä½ç½®**

2. ç‚¹å‡»ç¡®è®¤åï¼Œè§‚å¯Ÿæœºæ¢°è‡‚æ˜¯å¦**è‡ªåŠ¨ç§»åŠ¨åˆ°è¯¥ç‚¹**

3. æµ‹é‡è¯¯å·®ï¼š
   - ä¼˜ç§€ï¼š< 5mm
   - è‰¯å¥½ï¼š5-10mm
   - éœ€é‡æ–°æ ‡å®šï¼š> 10mm

**æé«˜ç²¾åº¦çš„æ–¹æ³•**ï¼š
- ä½¿ç”¨ ArUco æ ‡è®°è‡ªåŠ¨æ£€æµ‹(æ›´ç²¾ç¡®)
- å¢åŠ æ ‡å®šç‚¹æ•°é‡ï¼ˆ6-8 ä¸ªç‚¹ï¼‰
- é€‰æ‹©åˆ†å¸ƒæ›´å‡åŒ€çš„ç‚¹
- ä½¿ç”¨æ›´é«˜åˆ†è¾¨ç‡çš„æ‘„åƒå¤´
- å‡å°‘æ‘„åƒå¤´ç•¸å˜ï¼ˆä½¿ç”¨é•œå¤´æ ¡æ­£ï¼‰

---

## ğŸ§ª Day 5: æ•´ä½“é›†æˆæµ‹è¯•

### æµ‹è¯•ç”¨ä¾‹æ¸…å•

#### âœ… ç”¨ä¾‹ 1ï¼šæ¨¡æ‹Ÿæ¨¡å¼æµ‹è¯•

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|---------|
| 1 | å¯åŠ¨ç³»ç»Ÿï¼Œé»˜è®¤æ¨¡æ‹Ÿæ¨¡å¼ | 3D æ¨¡å‹æ­£å¸¸æ˜¾ç¤º |
| 2 | æŒ‰ A/D é”®æ§åˆ¶åŸºåº§ | æ¨¡å‹æ—‹è½¬æµç•… |
| 3 | ç‚¹å‡»"æµ‹è¯•åºåˆ—" | è‡ªåŠ¨æ‰§è¡Œæ¼”ç¤ºåŠ¨ä½œ |

---

#### âœ… ç”¨ä¾‹ 2ï¼šå®ç‰©æ¨¡å¼æµ‹è¯•

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|---------|
| 1 | åˆ‡æ¢åˆ°"å®ç‰©"æ¨¡å¼ | æ˜¾ç¤º"å®ç‰©æ¨¡å¼å·²å¯ç”¨" |
| 2 | æŒ‰ W/S é”®æ§åˆ¶å¤§è‡‚ | å®ä½“æœºæ¢°è‡‚ç§»åŠ¨ |
| 3 | è§‚å¯Ÿè§’åº¦æ˜¾ç¤º | å®æ—¶æ›´æ–°çœŸå®è§’åº¦ |
| 4 | æ‰‹åŠ¨ç§»åŠ¨æœºæ¢°è‡‚ | å‰ç«¯è§’åº¦è·Ÿéšå˜åŒ– |

---

#### âœ… ç”¨ä¾‹3ï¼šæ‘„åƒå¤´è§†è§‰æŠ“å–

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|---------|
| 1 | æ‰“å¼€æ‘„åƒå¤´ | æ˜¾ç¤ºå®æ—¶ç”»é¢ |
| 2 | ç‚¹å‡»ç‰©ä½“ä½ç½® | æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡† |
| 3 | ç‚¹å‡»ç¡®è®¤ | æœºæ¢°è‡‚ç§»åŠ¨åˆ°è¯¥ç‚¹ |
| 4 | åˆ°è¾¾åæŒ‰ Space | å¤¹çˆªå¤¹ç´§ |

---

#### âœ… ç”¨ä¾‹ 4ï¼šè¯­éŸ³æ§åˆ¶

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|---------|
| 1 | ç‚¹å‡»éº¦å…‹é£å›¾æ ‡ | æ˜¾ç¤ºå£°æ³¢åŠ¨ç”» |
| 2 | è¯´"å¤ä½" | æœºæ¢°è‡‚å›åˆ°åˆå§‹ä½ç½® |
| 3 | è¯´"æŒ¥æŒ¥æ‰‹" | æ‰§è¡ŒæŒ¥æ‰‹åŠ¨ä½œ |

---

#### âœ… ç”¨ä¾‹ 5ï¼šLLM æ™ºèƒ½æ§åˆ¶

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|---------|
| 1 | å¯¹è¯æ¡†è¾“å…¥"æŠ“å–çº¢çƒ" | LLM ç†è§£éœ€æ±‚ |
| 2 | ç¡®è®¤æ‰§è¡Œ | æœºæ¢°è‡‚ç§»åŠ¨ã€å¤¹ç´§ |

---

### æ€§èƒ½åŸºå‡†æµ‹è¯•

| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹è¯•æ–¹æ³• |
|------|------|---------|
| ä¸²å£å»¶è¿Ÿ | < 50ms | å‘é€æŒ‡ä»¤åˆ°æ”¶åˆ°å›ä¼ çš„æ—¶é—´ |
| è§’åº¦åˆ·æ–°ç‡ | â‰¥ 10Hz | è§‚å¯Ÿé¥æµ‹æ•°æ®é¢‘ç‡ |
| æ ‡å®šç²¾åº¦ | < 10mm | å¤šç‚¹éªŒè¯è¯¯å·® |
| WebSocket å»¶è¿Ÿ | < 100ms | å‰ç«¯åˆ°åç«¯å¾€è¿”æ—¶é—´ |

---

## ğŸ“ å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1ï¼šä¸²å£è¿æ¥å¤±è´¥

**ç—‡çŠ¶**ï¼š
```
SerialException: Could not open port COM3
```

**æ£€æŸ¥æ¸…å•**ï¼š
- [ ] ä¸²å£å·æ˜¯å¦æ­£ç¡®ï¼Ÿ
- [ ] é©±åŠ¨æ˜¯å¦å®‰è£…ï¼Ÿï¼ˆCH340/CP2102ï¼‰
- [ ] æ˜¯å¦è¢«å…¶ä»–ç¨‹åºå ç”¨ï¼Ÿï¼ˆå…³é—­ Arduino IDEï¼‰
- [ ] Linux æƒé™ï¼Ÿ`sudo usermod -a -G dialout $USER`

---

### é—®é¢˜ 2ï¼šè§’åº¦ä¸æ›´æ–°

**ç—‡çŠ¶**ï¼šå‰ç«¯ä¸€ç›´æ˜¾ç¤º `[0, 0, 0, 0, 0, 0]`

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥ `config.json` ä¸­ `SERIAL_ENABLED: true`
2. æŸ¥çœ‹åç«¯æ—¥å¿—ï¼š`docker-compose logs ai-service`
3. ç¡®è®¤ `read_status()` è¿”å›çš„ `serial_mock` æ˜¯ `false`
4. æ‰‹åŠ¨æµ‹è¯•ï¼š`python test_serial.py`

---

### é—®é¢˜ 3ï¼šæ ‡å®šåç‚¹å‡»ä½ç½®ä¸å‡†

**å¯èƒ½åŸå› **ï¼š

| åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|---------|
| æ ‡å®šç‚¹è¿‡å°‘ | å¢åŠ åˆ° 6-8 ä¸ªç‚¹ |
| ç‚¹åˆ†å¸ƒä¸å‡ | é‡æ–°é€‰æ‹©è¦†ç›–æ•´ä¸ªå·¥ä½œåŒºåŸŸ |
| æ‘„åƒå¤´ç§»åŠ¨äº† | é‡æ–°æ ‡å®š |
| é€è§†ç•¸å˜å¤§ | ä½¿ç”¨ç•¸å˜æ ¡æ­£ |

---

### é—®é¢˜ 4ï¼šæœºæ¢°è‡‚å“åº”æ…¢

**ä¼˜åŒ–æ–¹å‘**ï¼š
1. é™ä½ `SERIAL_TIMEOUT`ï¼ˆå¦‚ 0.5 ç§’ï¼‰
2. æé«˜é¥æµ‹é¢‘ç‡ï¼ˆ`main.py` ä¸­ `asyncio.sleep(0.05)`ï¼‰
3. ä½¿ç”¨ç¡¬ä»¶æµæ§åˆ¶ï¼ˆRTS/CTSï¼‰

---

## ğŸ“ è¿›é˜¶ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

### 1. åŠ¨æ€é¿éšœ

åœ¨ `advanced_ik.py` ä¸­å¯ç”¨ç¢°æ’æ£€æµ‹ï¼š

```python
def solve_ik_with_collision(self, target_pos, obstacles):
    # æ£€æŸ¥è·¯å¾„æ˜¯å¦ä¸éšœç¢ç‰©ç›¸äº¤
    for obstacle in obstacles:
        if self._check_collision(target_pos, obstacle):
            return self._find_alternative_path(target_pos, obstacle)
    return self.solve_ik(target_pos)
```

### 2. åŠ¨ä½œå½•åˆ¶ä¸å›æ”¾

```python
# å½•åˆ¶æ¨¡å¼
recorded_motion = []
while recording:
    status = transport.read_status()
    recorded_motion.append({
        "time": time.time(),
        "angles": status["angles_rad"]
    })

# å›æ”¾
for frame in recorded_motion:
    transport.send_command(frame["angles"])
    time.sleep(frame["time"] - prev_time)
```

### 3. åŠ›åé¦ˆï¼ˆå¦‚æœç¡¬ä»¶æ”¯æŒï¼‰

```python
def read_status_with_force(self):
    status = self.read_status()
    # è§£æåŠ›ä¼ æ„Ÿå™¨æ•°æ®
    status["force"] = self._parse_force_data()
    return status
```

---

## ğŸ› ï¸ è°ƒè¯•å·¥å…·é€ŸæŸ¥è¡¨

### å¿«é€Ÿå¯åŠ¨

```powershell
# å›¾å½¢åŒ–èœå•(æ¨è)
debug-tools.bat          # Windows
./debug-tools.sh         # Linux/MacOS
```

### å„å·¥å…·ç›´æ¥å‘½ä»¤

| å·¥å…· | å‘½ä»¤ | ç”¨é€” |
|------|------|------|
| ä¸²å£ç›‘è§†å™¨ | `python tools/serial_monitor.py --port COM3` | å®æ—¶æŸ¥çœ‹ä¸²å£é€šä¿¡ |
| ArUco ç”Ÿæˆ | `python tools/generate_aruco_marker.py --id 0` | ç”Ÿæˆæ ‡å®šæ ‡è®° |
| æ ‡å®šåŠ©æ‰‹ | `python tools/camera_calibration_helper.py` | æ‘„åƒå¤´æ ‡å®š |
| ç¡¬ä»¶æµ‹è¯• | `python tools/hardware_test_suite.py --port COM3` | è‡ªåŠ¨åŒ–æµ‹è¯• |

### ä¾èµ–å®‰è£…

```powershell
pip install -r tools/requirements.txt
```

---

## ğŸ“Š è°ƒè¯•è¿›åº¦è¿½è¸ªè¡¨

è‡ªå·±æ‰“å°å‡ºæ¥,å®Œæˆåæ‰“å‹¾:

```
ç¡¬ä»¶è°ƒè¯•è¿›åº¦è¡¨
=================

Day 0: å‡†å¤‡å·¥å…·
[ ] 0.1 å®‰è£… Python ä¾èµ– (pip install -r tools/requirements.txt)
[ ] 0.2 ç”Ÿæˆ ArUco æ ‡è®° (python tools/generate_aruco_marker.py --sheet ...)
[ ] 0.3 æ‰“å°æ ‡è®°å¹¶å‡†å¤‡

Day 1: ç¡¬ä»¶è¿æ¥
[ ] 1.1 ç¡®è®¤ä¸²å£å· (python tools/serial_monitor.py --list)
[ ] 1.2 é…ç½® config.json
[ ] 1.3 åŸºç¡€è¿æ¥æµ‹è¯•

Day 2: ä¸²å£è°ƒè¯•
[ ] 2.1 ä½¿ç”¨ä¸²å£ç›‘è§†å™¨åˆ†æåè®® (debug-tools.bat)
[ ] 2.2 ä¿®æ”¹ read_status()
[ ] 2.3 ä¿®æ”¹ send_command()
[ ] 2.4 è¿è¡Œ test_serial.py

Day 3: è§’åº¦éªŒè¯
[ ] 3.1 å¯åŠ¨å®Œæ•´ç³»ç»Ÿ
[ ] 3.2 å‰ç«¯å®æ—¶ç›‘æ§
[ ] 3.3 æ ¡å‡†è§’åº¦é›¶ç‚¹
[ ] 3.4 æ§åˆ¶é—­ç¯æµ‹è¯•

Day 4: æ‘„åƒå¤´æ ‡å®š
[ ] 4.1 é…ç½®æ‘„åƒå¤´
[ ] 4.2 å›ºå®šå®‰è£…ä½ç½®
[ ] 4.3 ä½¿ç”¨æ ‡å®šåŠ©æ‰‹ (python tools/camera_calibration_helper.py)
[ ] 4.4 éªŒè¯æ ‡å®šç²¾åº¦

Day 5: æ•´ä½“æµ‹è¯•
[ ] 5.1 è¿è¡Œç¡¬ä»¶æµ‹è¯•å¥—ä»¶ (python tools/hardware_test_suite.py --port COM3)
[ ] 5.2 æ¨¡æ‹Ÿæ¨¡å¼æµ‹è¯•
[ ] 5.3 å®ç‰©æ¨¡å¼æµ‹è¯•
[ ] 5.4 è§†è§‰æŠ“å–æµ‹è¯•
[ ] 5.5 è¯­éŸ³æ§åˆ¶æµ‹è¯•

å®Œæˆ! ğŸ‰
```

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°å¡ä½çš„é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ—¥å¿—**ï¼š
   ```bash
   docker-compose logs -f
   ```

2. **æ£€æŸ¥ç½‘ç»œ**ï¼š
   ```bash
   curl http://localhost:5000/api/health
   ```

3. **é‡å¯æœåŠ¡**ï¼š
   ```bash
   docker-compose restart ai-service
   ```

4. **æäº¤ Issue**ï¼š
   åœ¨ GitHub ä»“åº“æäº¤é—®é¢˜ï¼Œé™„ä¸Šï¼š
   - é”™è¯¯æ—¥å¿—
   - `config.json` é…ç½®
   - ç¡¬ä»¶å‹å·

---

## âœ… æ€»ç»“

å®Œæˆä¸Šè¿° 5 å¤©çš„è°ƒè¯•åï¼Œä½ çš„ç³»ç»Ÿå°†å®ç°ï¼š

âœ… å®æ—¶è§’åº¦å›ä¼ ï¼ˆ10Hz åˆ·æ–°ï¼‰
âœ… åŒå‘æ§åˆ¶ï¼ˆæ‰‹åŠ¨ + ç¨‹åºæ§åˆ¶ï¼‰
âœ… æ‘„åƒå¤´è§†è§‰å®šä½ï¼ˆ<10mm ç²¾åº¦ï¼‰
âœ… è¯­éŸ³/LLM æ™ºèƒ½æ§åˆ¶
âœ… å®Œæ•´çš„ç›‘æ§ç•Œé¢

**ä½ å°†æ‹¥æœ‰ä¸€ä¸ªå®Œå…¨å¯ç”¨çš„æœºæ¢°è‡‚æ§åˆ¶ç³»ç»Ÿï¼** ğŸ‰ğŸ¤–

---

**ç¥è°ƒè¯•é¡ºåˆ©ï¼æœ‰é—®é¢˜éšæ—¶é—®æˆ‘ã€‚** ğŸ˜Š
